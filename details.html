<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Track Hot Wheels Mattel Creations inventory with real-time stock updates. See stock levels, estimate production runs, and decide when to buy. Available in English and Ukrainian.">
    <meta name="keywords" content="Hot Wheels inventory, Mattel Creations stock, die-cast collectibles, toy car tracker, Hot Wheels RLC, Elite 64, залишки ХотВілс, колекційні машинки, тираж ХотВілс">
    <meta name="author" content="DGarageDiecast">
    <meta name="robots" content="index, follow">

    <!-- Canonical and Hreflang -->
    <link rel="canonical" href="https://sites.google.com/view/dgaragediecast/mattel-creations/hw-stock-info">
    <link rel="alternate" hreflang="uk" href="https://sites.google.com/view/dgaragediecast/mattel-creations/hw-stock-info">
    <link rel="alternate" hreflang="en" href="https://sites.google.com/view/dgaragediecast/mattel-creations/hw-stock-info">
    <link rel="alternate" hreflang="x-default" href="https://sites.google.com/view/dgaragediecast/mattel-creations/hw-stock-info">

    <!-- Open Graph -->
    <meta property="og:title" content="Hot Wheels Inventory Tracker | Залишки ХотВілс">
    <meta property="og:description" content="Get real-time Hot Wheels Mattel Creations stock updates. Check availability, estimate production runs, and make smart buying decisions. For collectors worldwide!">
    <meta property="og:image" content="https://example.com/images/hw_inventory.jpg">
    <meta property="og:image:alt" content="Hot Wheels Inventory Tracker preview with stock data">
    <meta property="og:url" content="https://sites.google.com/view/dgaragediecast/mattel-creations/hw-stock-info">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="uk_UA">
    <meta property="og:locale:alternate" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Hot Wheels Inventory Tracker | Залишки ХотВілс">
    <meta name="twitter:description" content="Real-time Hot Wheels stock updates from Mattel Creations. Track inventory, check production runs, and plan your collection in English or Ukrainian!">
    <meta name="twitter:image" content="https://example.com/images/hw_inventory.jpg">
    <meta name="twitter:image:alt" content="Hot Wheels Inventory Tracker preview with stock data">
    <meta name="twitter:site" content="@DGarageDiecast">
    <meta name="twitter:creator" content="@DGarageDiecast">
    <title>Hot Wheels Inventory</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .filters {
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .filters select, .filters input {
            padding: 8px;
            font-size: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            cursor: pointer;
        }
        th:hover {
            background-color: #e0e0e0;
        }
        img {
            max-width: 100px;
            height: auto;
        }
        a {
            color: #007bff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .sold-out {
            background-color: #ffebee; /* Легкий червоний фон для проданих */
            color: #d32f2f; /* Темно-червоний текст */
        }
        @media (max-width: 600px) {
            table, th, td {
                font-size: 14px;
            }
            img {
                max-width: 50px;
            }
        }
    </style>
</head>
<body>
    <h1>Hot Wheels Inventory</h1>
    <div class="filters">
        <select id="categoryFilter">
            <option value="all">ALL</option>
            <option value="RLC">RLC</option>
            <option value="Elite 64">Elite 64</option>
            <option value="Premium">Premium</option>
            <option value="Matchbox">Matchbox</option>
            <option value="Other">Others</option>
        </select>
        <select id="availabilityFilter">
            <option value="all">ALL</option>
            <option value="inStock">In Stock</option>
            <option value="soldOut">Sold Out</option>
        </select>
        <input type="text" id="nameFilter" placeholder="Search by name..." style="padding: 8px; font-size: 16px;">
    </div>
    <table id="inventoryTable">
        <thead>
            <tr>
                <th data-sort="category">Category</th>
                <th data-sort="image_url">Image</th>
                <th data-sort="car_name">Name</th>
                <th data-sort="current_qty">Current Qty</th>
                <th data-sort="max_qty">Max Qty</th>
                <th data-sort="price">Price ($)</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <script>
        // Завантаження даних із CSV
        async function loadData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/shady333/HWMCInventory/main/output.csv');
                const text = await response.text();
                const rows = text.split('\n').slice(1); // Пропускаємо заголовок
                const data = rows.map(row => {
                    const [car_name, SKU, page_name, max_qty, current_qty, image_url, price] = row.split(',');
                    return { car_name, SKU, page_name, max_qty: parseInt(max_qty), current_qty: parseInt(current_qty), image_url, price: parseFloat(price) };
                }).filter(item => item.car_name && !item.car_name.startsWith('"')); // Фільтр для видалення рядків, що починаються з "
                return data;
            } catch (error) {
                console.error('Помилка завантаження даних:', error);
                return [];
            }
        }

        // Визначення категорії
        function getCategory(car_name) {
            if (car_name.includes('RLC')) return 'RLC';
            if (car_name.includes('Elite 64')) return 'Elite 64';
            if (car_name.includes('Premium')) return 'Premium';
            if (car_name.includes('Matchbox')) return 'Matchbox';
            return 'Інші';
        }

        // Сортування даних
        function sortData(data, sortKey, sortDirection) {
            return [...data].sort((a, b) => {
                let valA = a[sortKey];
                let valB = b[sortKey];
                if (sortKey === 'car_name' || sortKey === 'image_url' || sortKey === 'category') {
                    valA = valA.toLowerCase();
                    valB = valB.toLowerCase();
                }
                if (valA < valB) return sortDirection === 'asc' ? -1 : 1;
                if (valA > valB) return sortDirection === 'asc' ? 1 : -1;
                return 0;
            });
        }

        // Відображення даних у таблиці
        function renderTable(data, categoryFilter, availabilityFilter, nameFilter, sortKey = 'car_name', sortDirection = 'asc') {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            const filteredData = data.filter(item => {
                const category = getCategory(item.car_name);
                const isCategoryMatch = categoryFilter === 'all' || category === categoryFilter;
                const isAvailabilityMatch =
                    availabilityFilter === 'all' ||
                    (availabilityFilter === 'inStock' && item.current_qty > 0) ||
                    (availabilityFilter === 'soldOut' && item.current_qty === 0);
                const isNameMatch = !nameFilter || item.car_name.toLowerCase().includes(nameFilter.toLowerCase());
                return isCategoryMatch && isAvailabilityMatch && isNameMatch;
            });

            const sortedData = sortData(filteredData, sortKey, sortDirection);

            sortedData.forEach(item => {
                const category = getCategory(item.car_name);
                const isSoldOut = item.current_qty <= 0;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${category}</td>
                    <td><img src="${item.image_url}" alt="${item.car_name}"></td>
                    <td><a href="https://creations.mattel.com/products/${item.page_name}" target="_blank">${item.car_name}</a></td>
                    <td>${item.current_qty}</td>
                    <td>${item.max_qty}</td>
                    <td>${item.price.toFixed(2)}</td>
                `;
                if (isSoldOut) {
                    row.classList.add('sold-out');
                }
                tableBody.appendChild(row);
            });
        }

        // Ініціалізація сторінки
        async function init() {
            const data = await loadData();
            const categoryFilter = document.getElementById('categoryFilter');
            const availabilityFilter = document.getElementById('availabilityFilter');
            const nameFilter = document.getElementById('nameFilter');

            // Завантаження збережених фільтрів із localStorage
            const savedCategory = localStorage.getItem('categoryFilter') || 'all';
            const savedAvailability = localStorage.getItem('availabilityFilter') || 'all';
            categoryFilter.value = savedCategory;
            availabilityFilter.value = savedAvailability;

            let currentSortKey = 'car_name';
            let currentSortDirection = 'asc';

            // Початкове відображення
            renderTable(data, savedCategory, savedAvailability, nameFilter.value.trim().toLowerCase(), currentSortKey, currentSortDirection);

            // Обробники подій для фільтрів
            categoryFilter.addEventListener('change', () => {
                localStorage.setItem('categoryFilter', categoryFilter.value);
                renderTable(data, categoryFilter.value, availabilityFilter.value, nameFilter.value.trim().toLowerCase(), currentSortKey, currentSortDirection);
            });
            availabilityFilter.addEventListener('change', () => {
                localStorage.setItem('availabilityFilter', availabilityFilter.value);
                renderTable(data, categoryFilter.value, availabilityFilter.value, nameFilter.value.trim().toLowerCase(), currentSortKey, currentSortDirection);
            });

            // Обробник подій для пошуку по назві
            nameFilter.addEventListener('input', () => {
                renderTable(data, categoryFilter.value, availabilityFilter.value, nameFilter.value.trim().toLowerCase(), currentSortKey, currentSortDirection);
            });

            // Обробник сортування
            document.querySelectorAll('th[data-sort]').forEach(header => {
                header.addEventListener('click', () => {
                    const sortKey = header.getAttribute('data-sort');
                    if (sortKey === currentSortKey) {
                        currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
                    } else {
                        currentSortKey = sortKey;
                        currentSortDirection = 'asc';
                    }
                    renderTable(data, categoryFilter.value, availabilityFilter.value, nameFilter.value.trim().toLowerCase(), currentSortKey, currentSortDirection);
                });
            });
        }

        // Запуск
        init();
    </script>
</body>
</html>
